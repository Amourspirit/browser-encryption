const DEFAULT_MSG="Please enter encryption type",ENCRYPT_WRAP=67,ENCRYPTED_STATE={NORMAL:0,EMPTY:1,ERR_NO_ENC:102,ERR_GEN:101},enc=()=>{if(!hpTest())return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);let e=getValPlain();if(0===e.length)return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);let t=getValMethod(),l=getValKey(),a=null,n=null,r=!1;try{switch(t){case"aes":a=CryptoJS.AES.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"3des":a=CryptoJS.DES.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"des":a=CryptoJS.TripleDES.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"rc4":a=CryptoJS.RC4.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"rb":a=CryptoJS.Rabbit.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;default:setValChipher(DEFAULT_MSG),setValEncState(ENCRYPTED_STATE.ERR_NO_ENC,!1)}}catch(e){setValChipher("Error occurred: Encryption failed..."),setValEncState(ENCRYPTED_STATE.ERR_GEN,!1)}!0===r&&(setValEncState(ENCRYPTED_STATE.NORMAL,!0),setKeyHidden(null))},dec=()=>{if(!hpTest())return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);let e=getValPlain();if(0===e.length)return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);let t=getValMethod(),l=getValKey(),a=null,n=!1;try{switch(t){case"3des":a=CryptoJS.DES.decrypt(removeWs(e),l),setValChipher(a.toString(CryptoJS.enc.Utf8)),n=!0;break;case"des":a=CryptoJS.TripleDES.decrypt(removeWs(e),l),setValChipher(a.toString(CryptoJS.enc.Utf8)),n=!0;break;case"aes":a=CryptoJS.AES.decrypt(removeWs(e),l),setValChipher(a.toString(CryptoJS.enc.Utf8)),n=!0;break;case"rc4":a=CryptoJS.RC4.decrypt(removeWs(e),l),setValChipher(a.toString(CryptoJS.enc.Utf8)),n=!0;break;case"rb":a=CryptoJS.Rabbit.decrypt(removeWs(e),l),setValChipher(a.toString(CryptoJS.enc.Utf8)),n=!0;break;default:setValChipher(DEFAULT_MSG),setValEncState(ENCRYPTED_STATE.ERR_NO_ENC,!1)}}catch(e){setValChipher("Error occurred: Decryption failed..."),setValEncState(ENCRYPTED_STATE.ERR_GEN,!1)}!0===n&&(setValEncState(ENCRYPTED_STATE.NORMAL,!0),setKeyHidden(null))},sha1=()=>{let e=getValPlain(),t=CryptoJS.SHA1(e);setValChipher(t.toString(CryptoJS.enc.Hex))},md=()=>{let e=getValPlain(),t=CryptoJS.MD5(e);setValChipher(t.toString(CryptoJS.enc.Hex))},sha3=()=>{let e=getValPlain(),t=CryptoJS.SHA3(e,{outputLength:224});setValChipher(t.toString(CryptoJS.enc.Hex))},selectFromQueryString=()=>{(()=>{let e=getParameterByName("enc",null);if(e)switch(e=e.toLowerCase(),e){case"aes":setValMethod("aes");break;case"3des":setValMethod("3des");break;case"des":setValMethod("des");break;case"rc4":setValMethod("rc4");break;case"rb":setValMethod("rb");break;default:setValMethod("def")}})(),(()=>{let e=getParameterByName("val",null);e&&setValPlain(e)})(),(()=>{let e=getParameterByName("key",null);e&&(setValKey(e),setKeyHidden(e))})()},genQuery=()=>{let e=getUrlPath();e+="?enc="+getValMethod(),e+="&val="+encodeURIComponent(getValChipher()),document.getElementById("chk_inckey").checked&&(e+="&key="+encodeURIComponent(getKeyHidden())),setValUrl(e)},getUrlPath=()=>{let e=window.location.pathname,t=getUrlCurrent();return e&&(t+=e),t},getUrlCurrent=()=>{let e=window.location.protocol,t=window.location.hostname,l=window.location.port,a=e+"//"+t;return l&&"80"!==l&&"443"!==l&&(a+=":"+l),a},hpTest=()=>{let e=document.getElementById("website");if(!e)return!1;let t=document.getElementById("name");return!!t&&(0===e.value.length&&0===t.value.length)},getValEncState=()=>document.getElementById("enc_state").value,setValEncState=(e,t)=>{e||(e=ENCRYPTED_STATE.NORMAL),t&&(getValChipher().length>0||(e=ENCRYPTED_STATE.EMPTY)),document.getElementById("enc_state").value=e},isValidEncState=()=>{let e=document.getElementById("enc_state");return!!e&&0==e.value},getValChipher=()=>getElChipher().value,setValChipher=e=>{getElChipher().value=e},getElChipher=()=>document.getElementById("chipher"),getValPlain=()=>getElPlain().value,setValPlain=e=>{getElPlain().value=e},getElPlain=()=>document.getElementById("plain"),getValKey=()=>getElKey().value,setValKey=e=>{getElKey().value=e},getElKey=()=>document.getElementById("key"),getValMethod=()=>document.getElementById("method").value,setValMethod=e=>{selectElement("method",e)},getValUrl=()=>getElUrl().value,setValUrl=e=>{getElUrl().value=e},getElUrl=()=>document.getElementById("url"),setKeyHidden=e=>{null==e&&(e=getValKey());let t=CryptoJS.AES.encrypt(e,RANDOM_INLINE_KEY);setValEncKey(t.toString())},getKeyHidden=()=>{let e=getValEncKey();return CryptoJS.AES.decrypt(e,RANDOM_INLINE_KEY).toString(CryptoJS.enc.Utf8)},getValEncKey=()=>getElEncKey().value,setValEncKey=e=>{getElEncKey().value=e},getElEncKey=()=>document.getElementById("enc_key"),togglePassword=()=>{let e=getElKey();"password"===e.type?e.type="text":e.type="password"},swap=()=>{let e=getValPlain(),t=getValChipher();setValChipher(e),setValPlain(t),setValEncState(null,!0)},selectElement=(e,t)=>{document.getElementById(e).value=t},removeWs=e=>e.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),getParameterByName=(e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var l=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return l?l[2]?decodeURIComponent(l[2].replace(/\+/g," ")):"":null},uiRefresh=()=>{const e=e=>{let t=document.createDocumentFragment(),l=document.createElement("div");for(l.innerHTML=e;l.firstChild;)t.appendChild(l.firstChild);return t},t=(t,l)=>{let a=3;const n="object"==typeof observer;l.length<3&&12%l.length==0&&(a=l.length);let r=12/a;const o=e=>{let t="<img ";return t+=n?'class="lozad" data-src="'+e+'"':'src="'+e+'"',t+=' alt="" style="width:100%" />',t};let s=0,c=Math.floor(l.length/a),i=l.length%a,d=c;i>0&&(d+=a);let h="";if(l.forEach(l=>{s++,1===s&&(h='<div class="row">'),h+=(e=>{let t='<div class="col-md-'+r+'">';return t+='<div class="thumbnail">',t+='<a href="'+e+'" target="_blank">',t+=o(e),t+="</a></div></div>",t})(l),s===a&&(s=0,h+="</div>",t.appendChild(e(h)))}),i>0){const l=a-i;for(let e=0;e<l;e++)h+='<div class="col-md-'+r+'"></div>';h+="</div>",t.appendChild(e(h))}n&&observer.observe()},l=(l,a)=>{let n=l.match(/(https?:\/\/(?:[0-9A-Za-z\-]+\.)+[a-z]{2,6}(?:\/[^\/#?]+)+\.(?:jpe?g|gif|a?png|webp|svg))/gm);a.innerHTML="";let r=!1;return n?(n.length>1?t(a,n):((t,l)=>{let a='<a href="'+l+'" target="_blank">';a+='<img src="'+l+'" class="img-responsive center-block" alt="image">',a+="</a>",t.appendChild(e(a))})(a,n[0]),$("#found_img_pnl").collapse("show"),r=!0):$("#found_img_pnl").collapse("hide"),r};(()=>{let t=document.getElementById("enc_state").value==ENCRYPTED_STATE.NORMAL,a=getValChipher();const n=document.getElementById("found_links"),r=document.getElementById("found_images");t&&a?(document.getElementById("row_url").style.display="block",document.getElementById("row_chipher_btn").style.display="block",((t,l)=>{let a=t.match(/http(s)?:\/\/.(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b(.(?!\.jpg|\.png|\.gif|\.jpeg$))+$/gm);l.innerHTML="";let n="",r=!1;a?(n="<ul>",a.forEach(e=>{n+='<li><a href="'+e+'" target="_blank">'+e+"</a></li>"}),n+="</ul>",l.appendChild(e(n)),$("#found_links_pnl").collapse("show"),r=!0):$("#found_links_pnl").collapse("hide")})(a,n),l(a,r)):(document.getElementById("row_url").style.display="none",document.getElementById("row_chipher_btn").style.display="none",n.innerHTML="",r.innerHTML="",$("#found_links_pnl").collapse("hide"),$("#found_img_pnl").collapse("hide"))})()},processKeygen=e=>{let t=e/8,l=!1;document.getElementById("chk_hex").checked&&(t+=t,l=!0),setValKey(((e,t)=>{const l={alpha:!1,num:!1,symbols:!1,special:!1,hex:!1,ws:!1,b64:!1,ekey:!1};return t?l.hex=!0:l.ekey=!0,keygenJS(e,l)})(t,l))};