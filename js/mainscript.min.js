const DEFAULT_MSG="Please enter encryption type",ENCRYPT_WRAP=67,ENCRYPTED_STATE={NORMAL:0,EMPTY:1,ERR_NO_ENC:102,ERR_GEN:101},enc=()=>{if(!hpTest())return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);let e=getValPlain();if(0===e.length)return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);window.USE_PURIFY&&(e=DOMPurify.sanitize(e));let t=getValMethod(),l=getValKey(),a=null,n=null,r=!1;try{switch(t){case"aes":a=CryptoJS.AES.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"3des":a=CryptoJS.DES.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"des":a=CryptoJS.TripleDES.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"rc4":a=CryptoJS.RC4.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;case"rb":a=CryptoJS.Rabbit.encrypt(e,l),n=strBreaker(a.toString(),{width:67}),setValChipher(n.join("\n")),r=!0;break;default:setValChipher(DEFAULT_MSG),setValEncState(ENCRYPTED_STATE.ERR_NO_ENC,!1)}}catch(e){setValChipher("Error occurred: Encryption failed..."),setValEncState(ENCRYPTED_STATE.ERR_GEN,!1)}!0===r&&(setValEncState(ENCRYPTED_STATE.NORMAL,!0),setKeyHidden(null))},dec=()=>{if(!hpTest())return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);let e=getValPlain();if(0===e.length)return setValChipher(""),void setValEncState(ENCRYPTED_STATE.EMPTY,!1);let t=getValMethod(),l=getValKey(),a=null,n=!1,r=null;try{switch(t){case"3des":a=CryptoJS.DES.decrypt(removeWs(e),l),r=a.toString(CryptoJS.enc.Utf8),window.USE_PURIFY&&(r=DOMPurify.sanitize(r)),setValChipher(r),n=!0;break;case"des":a=CryptoJS.TripleDES.decrypt(removeWs(e),l),r=a.toString(CryptoJS.enc.Utf8),window.USE_PURIFY&&(r=DOMPurify.sanitize(r)),setValChipher(r),n=!0;break;case"aes":a=CryptoJS.AES.decrypt(removeWs(e),l),r=a.toString(CryptoJS.enc.Utf8),window.USE_PURIFY&&(r=DOMPurify.sanitize(r)),setValChipher(r),n=!0;break;case"rc4":a=CryptoJS.RC4.decrypt(removeWs(e),l),r=a.toString(CryptoJS.enc.Utf8),window.USE_PURIFY&&(r=DOMPurify.sanitize(r)),setValChipher(r),n=!0;break;case"rb":a=CryptoJS.Rabbit.decrypt(removeWs(e),l),r=a.toString(CryptoJS.enc.Utf8),window.USE_PURIFY&&(r=DOMPurify.sanitize(r)),setValChipher(r),n=!0;break;default:setValChipher(DEFAULT_MSG),setValEncState(ENCRYPTED_STATE.ERR_NO_ENC,!1)}}catch(e){setValChipher("Error occurred: Decryption failed..."),setValEncState(ENCRYPTED_STATE.ERR_GEN,!1)}!0===n&&(setValEncState(ENCRYPTED_STATE.NORMAL,!0),setKeyHidden(null))},sha1=()=>{let e=getValPlain(),t=CryptoJS.SHA1(e);setValChipher(t.toString(CryptoJS.enc.Hex))},md=()=>{let e=getValPlain(),t=CryptoJS.MD5(e);setValChipher(t.toString(CryptoJS.enc.Hex))},sha3=()=>{let e=getValPlain(),t=CryptoJS.SHA3(e,{outputLength:224});setValChipher(t.toString(CryptoJS.enc.Hex))},selectFromQueryString=()=>{(()=>{let e=getParameterByName("enc",null);if(e)switch(e=e.toLowerCase(),e){case"aes":setValMethod("aes");break;case"3des":setValMethod("3des");break;case"des":setValMethod("des");break;case"rc4":setValMethod("rc4");break;case"rb":setValMethod("rb");break;default:setValMethod("def")}})(),(()=>{let e=getParameterByName("val",null);e&&setValPlain(e)})(),(()=>{let e=getParameterByName("key",null);e&&(setValKey(e),setKeyHidden(e))})()},genQuery=()=>{let e=getUrlPath();e+="?enc="+getValMethod();let t=encodeURIComponent(getValChipher());if(t=t.replace(/\(/g,"%28").replace(/\)/g,"%29"),e+="&val="+t,document.getElementById("chk_inckey").checked){let t=encodeURIComponent(getKeyHidden());t=t.replace(/\(/g,"%28").replace(/\)/g,"%29"),e+="&key="+t}setValUrl(e)},getUrlPath=()=>{let e=window.location.pathname,t=getUrlCurrent();return e&&(t+=e),t},getUrlCurrent=()=>{let e=window.location.protocol,t=window.location.hostname,l=window.location.port,a=e+"//"+t;return l&&"80"!==l&&"443"!==l&&(a+=":"+l),a},hpTest=()=>{let e=document.getElementById("website");if(!e)return!1;let t=document.getElementById("name");return!!t&&(0===e.value.length&&0===t.value.length)},getValEncState=()=>document.getElementById("enc_state").value,setValEncState=(e,t)=>{e||(e=ENCRYPTED_STATE.NORMAL),t&&(getValChipher().length>0||(e=ENCRYPTED_STATE.EMPTY)),document.getElementById("enc_state").value=e},isValidEncState=()=>{let e=document.getElementById("enc_state");return!!e&&0==e.value},getValChipher=()=>getElChipher().value,setValChipher=e=>{getElChipher().value=e},getElChipher=()=>document.getElementById("chipher"),getValPlain=()=>getElPlain().value,setValPlain=e=>{getElPlain().value=e},getElPlain=()=>document.getElementById("plain"),getValKey=()=>getElKey().value,setValKey=e=>{getElKey().value=e},getElKey=()=>document.getElementById("key"),getValMethod=()=>document.getElementById("method").value,setValMethod=e=>{selectElement("method",e)},getValUrl=()=>getElUrl().value,setValUrl=e=>{getElUrl().value=e},getElUrl=()=>document.getElementById("url"),setKeyHidden=e=>{null==e&&(e=getValKey());let t=CryptoJS.AES.encrypt(e,RANDOM_INLINE_KEY);setValEncKey(t.toString())},getKeyHidden=()=>{let e=getValEncKey();return CryptoJS.AES.decrypt(e,RANDOM_INLINE_KEY).toString(CryptoJS.enc.Utf8)},getValEncKey=()=>getElEncKey().value,setValEncKey=e=>{getElEncKey().value=e},getElEncKey=()=>document.getElementById("enc_key"),togglePassword=()=>{let e=getElKey();"password"===e.type?e.type="text":e.type="password"},swap=()=>{let e=getValPlain(),t=getValChipher();setValChipher(e),setValPlain(t),setValEncState(null,!0)},selectElement=(e,t)=>{document.getElementById(e).value=t},removeWs=e=>e.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),getParameterByName=(e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var l=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return l?l[2]?decodeURIComponent(l[2].replace(/\+/g," ")):"":null},uiRefresh=()=>{const e=e=>{let t=document.createDocumentFragment(),l=document.createElement("div");for(l.innerHTML=e;l.firstChild;)t.appendChild(l.firstChild);return t},t=(t,l)=>{let a=3;l.length<3&&12%l.length==0&&(a=l.length);let n=12/a;const r=e=>{let t="<img ";return window.USE_LAZY_LOAD?t+='class="lozad" data-src="'+e+'"':t+='src="'+e+'"',t+=' alt="" class="img-fluid rounded" alt="" style="width:100%"/>',t};let i=0,o=Math.floor(l.length/a),s=l.length%a,c=o;s>0&&(c+=a);let d="";if(l.forEach(l=>{i++,1===i&&(d='<div class="row" style="margin: 15px;">'),d+=(e=>{let t='<div class="col-md-'+n+'">';return t+='<a href="'+e+'" data-toggle="lightbox" data-gallery="gallery">',t+=r(e),t+="</a></div>",t})(l),i===a&&(i=0,d+="</div>",t.appendChild(e(d)))}),s>0){const l=a-s;for(let e=0;e<l;e++)d+='<div class="col-md-'+n+'"></div>';d+="</div>",t.appendChild(e(d))}window.USE_LAZY_LOAD&&observer.observe()},l=(l,a)=>{let n=l.match(/(?:https?\:\/\/)([a-zA-Z0-9][a-zA-Z0-9-_]*\.)*[a-zA-Z0-9]*[a-zA-Z0-9-_]*[[a-zA-Z0-9]+\/(?:[^\s\/]+\/)*(?:[^\s]+\.(?:jpe?g|gif|png|webp|svg|apng))(?:\?\w+=\w+(?:&\w+=\w+)*)?/gm);a.innerHTML="";let r=!1;return n?(n.length>1?t(a,n):((t,l)=>{let a='<a href="'+l+'" target="_blank">';a+='<img src="'+l+'" class="img-responsive center-block" alt="image">',a+="</a>",t.appendChild(e(a))})(a,n[0]),$(".card-img").show(),$("#found_img_pnl").collapse("show"),r=!0):($("#found_img_pnl").collapse("hide"),$(".card-img").hide()),r};(()=>{let e=getValEncState()==ENCRYPTED_STATE.NORMAL,t=getValChipher();const a=document.getElementById("found_images");e&&t?($("#row_url").show(),$("#row_chipher_btn").show(),l(t,a)):($("#row_url").hide(),$("#row_chipher_btn").hide(),a.innerHTML="",$("#found_img_pnl").collapse("hide"))})(),(()=>{let e=getValEncState()==ENCRYPTED_STATE.NORMAL,t=getValChipher();const l=document.getElementById("found_content");if(l.innerHTML="",e&&t){let e=marked(t);if(window.USE_PURIFY&&(e=DOMPurify.sanitize(e)),window.USE_LAZY_LOAD){let t=$(e).lazyLoadExt();$(l).append(t)}else l.innerHTML=e;$(".card-content").show(),$("#found_content_pnl").collapse("show"),window.USE_LAZY_LOAD&&window.observer.observe()}else l.innerHTML="",$("#found_content_pnl").collapse("hide"),$(".card-content").hide()})()},processKeygen=e=>{let t=e/8,l=!1;document.getElementById("chk_hex").checked&&(t+=t,l=!0),setValKey(((e,t)=>{const l={alpha:!1,num:!1,symbols:!1,special:!1,hex:!1,ws:!1,b64:!1,ekey:!1};return t?l.hex=!0:l.ekey=!0,keygenJS(e,l)})(t,l))};