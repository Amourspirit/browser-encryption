const DEFAULT_MSG="Please enter encryption type",ENCRYPT_WRAP=67,enc=()=>{let e=getMethodVal(),t=getKeyVal(),l=getPlainVal(),r=null,a=null;try{switch(e){case"def":setChipherVal(DEFAULT_MSG);break;case"aes":r=CryptoJS.AES.encrypt(l,t),a=strBreaker(r.toString(),{width:67}),setChipherVal(a.join("\n"));break;case"3des":r=CryptoJS.DES.encrypt(l,t),a=strBreaker(r.toString(),{width:67}),setChipherVal(a.join("\n"));break;case"des":r=CryptoJS.TripleDES.encrypt(l,t),a=strBreaker(r.toString(),{width:67}),setChipherVal(a.join("\n"));break;case"rc4":r=CryptoJS.RC4.encrypt(l,t),a=strBreaker(r.toString(),{width:67}),setChipherVal(a.join("\n"));break;case"rb":r=CryptoJS.Rabbit.encrypt(l,t),a=strBreaker(r.toString(),{width:67}),setChipherVal(a.join("\n"))}}catch(e){setChipherVal("Error occurred: Encryption failed...")}},dec=()=>{let e=getMethodVal(),t=getKeyVal(),l=getPlainVal(),r=null;try{switch(e){case"def":setChipherVal(DEFAULT_MSG);break;case"3des":r=CryptoJS.DES.decrypt(removeWs(l),t),setChipherVal(r.toString(CryptoJS.enc.Utf8));break;case"des":r=CryptoJS.TripleDES.decrypt(removeWs(l),t),setChipherVal(r.toString(CryptoJS.enc.Utf8));break;case"aes":r=CryptoJS.AES.decrypt(removeWs(l),t),setChipherVal(r.toString(CryptoJS.enc.Utf8));break;case"rc4":r=CryptoJS.RC4.decrypt(removeWs(l),t),setChipherVal(r.toString(CryptoJS.enc.Utf8));break;case"rb":r=CryptoJS.Rabbit.decrypt(removeWs(l),t),setChipherVal(r.toString(CryptoJS.enc.Utf8))}}catch(e){setChipherVal("Error occurred: Decryption failed...")}},sha1=()=>{let e=getPlainVal(),t=CryptoJS.SHA1(e);setChipherVal(t.toString(CryptoJS.enc.Hex))},md=()=>{let e=getPlainVal(),t=CryptoJS.MD5(e);setChipherVal(t.toString(CryptoJS.enc.Hex))},sha3=()=>{let e=getPlainVal(),t=CryptoJS.SHA3(e,{outputLength:224});setChipherVal(t.toString(CryptoJS.enc.Hex))},selectFromQueryString=()=>{selectEncFromQuery(),getPlainFromQuery()},getPlainFromQuery=()=>{let e=getParameterByName("val",null);e&&setPlainVal(decodeURIComponent(e))},selectEncFromQuery=()=>{let e=getParameterByName("enc",null);if(e)switch(e=e.toLowerCase(),e){case"aes":setMethodVal("aes");break;case"3des":setMethodVal("3des");break;case"des":setMethodVal("des");break;case"rc4":setMethodVal("rc4");break;case"rb":setMethodVal("rb");break;default:setMethodVal("def")}},genQuery=()=>{let e=getUrlPath();e+="?enc="+getMethodVal(),e+="&val="+encodeURIComponent(getChipherVal()),setUrlVal(e)},getUrlPath=()=>{let e=window.location.pathname,t=getUrlCurrent();return e&&(t+=e),t},getUrlCurrent=()=>{let e=window.location.protocol,t=window.location.hostname,l=window.location.port,r=e+"//"+t;return l&&"80"!==l&&"443"!==l&&(r+=":"+l),r},getChipherVal=()=>getChipherEl().value,setChipherVal=e=>{getChipherEl().value=e},getChipherEl=()=>document.getElementById("chipher"),getPlainVal=()=>getPlainEl().value,setPlainVal=e=>{getPlainEl().value=e},getPlainEl=()=>document.getElementById("plain"),getKeyVal=()=>getKeyEl().value,setKeyVal=e=>{getKeyEl().value=e},getKeyEl=()=>document.getElementById("key"),getMethodVal=()=>document.getElementById("method").value,setMethodVal=e=>{selectElement("method",e)},getUrlVal=()=>getUrlEl().value,setUrlVal=e=>{getUrlEl().value=e},getUrlEl=()=>document.getElementById("url"),togglePassword=()=>{let e=getKeyEl();"password"===e.type?e.type="text":e.type="password"},swap=()=>{let e=getPlainVal(),t=getChipherVal();setChipherVal(e),setPlainVal(t)},selectElement=(e,t)=>{document.getElementById(e).value=t},removeWs=e=>e.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),getParameterByName=(e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var l=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return l?l[2]?decodeURIComponent(l[2].replace(/\+/g," ")):"":null},uiRefresh=()=>{(()=>{let e=getChipherVal(),t="";if(e){document.getElementById("row_url").style.display="block",document.getElementById("row_chipher_btn").style.display="block";let l=/^http(s)?:\/\/.(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b(.(?!\.jpg|\.png|\.gif|\.jpeg$))+$/gm,r=e.match(l);r?(t="<ul>",r.forEach(e=>{t+='<li><a href="'+e+'" target="_blank">'+e+"</a></li>"}),t+="</ul>",document.getElementById("found_link").innerHTML=t,$(".found-link").collapse("show")):(document.getElementById("found_link").innerHTML="",$(".found-link").collapse("hide"));let a=/(https?:\/\/(?:[a-z\-]+\.)+[a-z]{2,6}(?:\/[^\/#?]+)+\.(?:jpe?g|gif|png))/,n=e.match(a);n?(t='<a href="'+n[1]+'" target="_blank">',t+='<img src="'+n[1]+'" class="img-responsive center-block" alt="image">',t+="</a>",document.getElementById("found_image").innerHTML=t,$(".found-image").collapse("show")):(document.getElementById("found_image").innerHTML="",$(".found-image").collapse("hide"))}else document.getElementById("row_url").style.display="none",document.getElementById("row_chipher_btn").style.display="none",document.getElementById("found_link").innerHTML="",$(".found-link").collapse("hide"),document.getElementById("found_image").innerHTML="",$(".found-image").collapse("hide")})()},processKeygen=e=>{let t=e/8,l=!1;var r;document.getElementById("chk_hex").checked&&(t+=t,l=!0),r=((e,t)=>{const l={alpha:!1,num:!1,symbols:!1,special:!1,hex:!1,ws:!1,b64:!1,ekey:!1};return t?l.hex=!0:l.ekey=!0,keygenJS(e,l)})(t,l),getKeyEl().value=r};